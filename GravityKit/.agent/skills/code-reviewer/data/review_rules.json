{
    "rules": [
        {
            "id": "SEC001",
            "category": "security",
            "severity": "critical",
            "pattern": "(password|secret|api_key|apikey|token|private_key)\\s*=\\s*[\"'][^\"']+[\"']",
            "exclude_pattern": "(example|test|mock|sample|placeholder|env\\.|process\\.env|os\\.environ|getenv)",
            "message": "Hardcoded secret or credential detected",
            "suggestion": "Move to environment variables (.env) and use os.environ or process.env"
        },
        {
            "id": "SEC002",
            "category": "security",
            "severity": "critical",
            "pattern": "eval\\s*\\(|exec\\s*\\(",
            "exclude_pattern": "(#.*eval|//.*eval|test)",
            "message": "Use of eval() or exec() — potential code injection risk",
            "suggestion": "Avoid eval/exec. Use safer alternatives like JSON.parse() or ast.literal_eval()"
        },
        {
            "id": "SEC003",
            "category": "security",
            "severity": "warning",
            "pattern": "innerHTML\\s*=",
            "message": "Direct innerHTML assignment — potential XSS vulnerability",
            "suggestion": "Use textContent or sanitize input with DOMPurify"
        },
        {
            "id": "SEC004",
            "category": "security",
            "severity": "critical",
            "pattern": "f[\"'].*\\{.*\\}.*[\"'].*execute|cursor\\.execute\\s*\\(\\s*f[\"']",
            "message": "Potential SQL injection via f-string in query",
            "suggestion": "Use parameterized queries: cursor.execute('SELECT * FROM users WHERE id = ?', (user_id,))"
        },
        {
            "id": "SEC005",
            "category": "security",
            "severity": "warning",
            "pattern": "CORS.*\\*|Access-Control-Allow-Origin.*\\*",
            "message": "Wildcard CORS policy — allows any origin",
            "suggestion": "Restrict CORS to specific trusted domains"
        },
        {
            "id": "SEC006",
            "category": "security",
            "severity": "warning",
            "pattern": "http://(?!localhost|127\\.0\\.0\\.1)",
            "message": "HTTP URL detected — should use HTTPS",
            "suggestion": "Replace http:// with https:// for security"
        },
        {
            "id": "NAM001",
            "category": "naming",
            "severity": "info",
            "pattern": "\\b(data|info|temp|tmp|foo|bar|baz|xxx|yyy|test1|test2)\\b\\s*=",
            "exclude_pattern": "(#|//|test_|_test|spec)",
            "message": "Non-descriptive variable name",
            "suggestion": "Use meaningful variable names that describe the content (e.g., 'userData' instead of 'data')"
        },
        {
            "id": "NAM002",
            "category": "naming",
            "severity": "info",
            "pattern": "\\b[a-z]\\b\\s*=\\s*(?!0\\b|1\\b|True|False|None|null|undefined)",
            "exclude_pattern": "(for\\s|in\\s|range|enumerate|#|//|_\\s*=|i\\s*=|j\\s*=|k\\s*=|e\\s*=)",
            "message": "Single-character variable name (outside of loop counters)",
            "suggestion": "Use descriptive variable names for better readability"
        },
        {
            "id": "PERF001",
            "category": "performance",
            "severity": "warning",
            "pattern": "SELECT\\s+\\*\\s+FROM",
            "message": "SELECT * query — fetches unnecessary columns",
            "suggestion": "Specify only the columns you need: SELECT col1, col2 FROM table"
        },
        {
            "id": "PERF002",
            "category": "performance",
            "severity": "warning",
            "pattern": "for.*in.*:.*\\n.*\\s+(query|execute|fetch|find|get_or_create)",
            "message": "Potential N+1 query pattern — database call inside loop",
            "suggestion": "Use batch queries, prefetch_related(), or JOINs instead"
        },
        {
            "id": "PERF003",
            "category": "performance",
            "severity": "info",
            "pattern": "import\\s+time.*\\n.*time\\.sleep",
            "message": "Synchronous sleep detected — may block event loop",
            "suggestion": "Use asyncio.sleep() in async context or consider non-blocking alternatives"
        },
        {
            "id": "PERF004",
            "category": "performance",
            "severity": "warning",
            "pattern": "\\.append\\(.*\\).*for\\s+.*\\s+in",
            "message": "List append in loop — consider list comprehension",
            "suggestion": "Use list comprehension for better performance: [x for x in items]"
        },
        {
            "id": "QUAL001",
            "category": "scan",
            "severity": "warning",
            "pattern": "except\\s*:|except\\s+Exception\\s*:",
            "exclude_pattern": "(#.*except|//.*except|logging|logger|log\\.)",
            "message": "Broad exception catch — may hide bugs",
            "suggestion": "Catch specific exceptions (e.g., ValueError, KeyError) and log the error"
        },
        {
            "id": "QUAL002",
            "category": "scan",
            "severity": "info",
            "pattern": "(TODO|FIXME|HACK|XXX|TEMP|TEMPORARY)",
            "message": "TODO/FIXME comment found — pending work item",
            "suggestion": "Resolve or create a ticket for this item before shipping"
        },
        {
            "id": "QUAL003",
            "category": "scan",
            "severity": "warning",
            "pattern": "console\\.(log|warn|error|debug)\\(",
            "exclude_pattern": "(test|spec|debug|logger)",
            "message": "console.log left in production code",
            "suggestion": "Remove console.log or replace with proper logging library"
        },
        {
            "id": "QUAL004",
            "category": "scan",
            "severity": "warning",
            "pattern": "print\\s*\\(",
            "exclude_pattern": "(#.*print|test|cli|__main__|argparse|click|if\\s+__name__)",
            "message": "print() statement in production code",
            "suggestion": "Use logging module instead of print() for production code"
        },
        {
            "id": "QUAL005",
            "category": "scan",
            "severity": "critical",
            "pattern": "debugger;|breakpoint\\(\\)|import\\s+pdb",
            "message": "Debugger statement left in code",
            "suggestion": "Remove debugger/breakpoint statements before committing"
        },
        {
            "id": "QUAL006",
            "category": "scan",
            "severity": "info",
            "pattern": "\\bif\\b.*\\bif\\b.*\\bif\\b",
            "message": "Deeply nested conditionals — complexity concern",
            "suggestion": "Consider extracting into separate functions or using early returns"
        },
        {
            "id": "QUAL007",
            "category": "scan",
            "severity": "warning",
            "pattern": "\\b(var)\\s+\\w+\\s*=",
            "message": "Use of 'var' in JavaScript — prefer 'const' or 'let'",
            "suggestion": "Replace 'var' with 'const' (preferred) or 'let' for modern JS"
        },
        {
            "id": "QUAL008",
            "category": "scan",
            "severity": "info",
            "pattern": "==(?!=)|!=(?!=)",
            "exclude_pattern": "(python|py$|\\.py|#|None|True|False)",
            "message": "Loose equality check in JavaScript — use strict equality",
            "suggestion": "Use === and !== instead of == and != to avoid type coercion"
        }
    ]
}